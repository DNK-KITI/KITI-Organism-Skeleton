# KITI — Функциональный обзор

## Назначение

KITI — цифровой автономный организм, который:  
- живет на носителе с собственным CPU (USB-Armory, ESP32-S3, Pi Zero и др.);  
- ведет непрерывный журнал Heartbeat (жизненный пульс);  
- способен функционировать без подключения к интернету (offline-first);  
- хранит свое состояние в зашифрованном DNK-Vault;  
- может взаимодействовать с человеком и внешними системами.  

---

## Основные модули

### Core / Heartbeat  
- Отвечает за пульс системы, обновление статуса и журнал `heartbeat.log`.  
- Каждый tick фиксируется с prev_hash, timestamp и подписью.  

### DNK-Vault  
- Локальное шифрованное хранилище.  
- Хранит историю, конфигурацию и состояние организма.  
- Использует симметричное шифрование (AES-GCM) + подпись.  

### MINT-72 Identity  
- Биометрия + кодовое слово (duress word).  
- Обеспечивает уникальную идентичность устройства.  
- При тревожном слове — переход в защитный режим Kupol.  

### Kupol / Immunity Core  
- Защищает от несанкционированного доступа.  
- При нарушениях — изоляция ядра или временный freeze состояния.  
- Реализует “иммунитет” — блокирует запретные действия и API-вызовы.  

### Energy Manager  
- Контролирует источники питания (USB, батарея, солнечная панель).  
- При низком заряде активен только heartbeat и логирование.  

### Comms / Host Integration  
- При подключении к ПК выступает как USB-Ethernet + WebUI.  
- Может передавать heartbeat в локальную сеть.  
- Не требует авторуна — пользователь вручную открывает `http://192.168.7.2/`.  

### Local AI Layer  
- Минимальный офлайн-ИИ для распознавания голоса, генерации текста и ответов.  
- Работает без внешних API при отсутствии сети.  

---

## Архитектурный принцип

KITI — это не бот и не программа.  
Это организм, у которого есть:

| Слой | Назначение |
|------|-------------|
| Heartbeat | Жизненный пульс, журнал состояния |
| Vault | Память и ДНК устройства |
| Kupol | Защита и иммунная система |
| CoreBank (iCore) | Энергия и экономика поведения |
| SRL / MAG-R | Язык внутренних связей |
| Comms | Взаимодействие с внешним миром |

---

## Особенности поведения

- KITI не умирает при отключении питания — при вставке флешки он продолжает жизнь с того же состояния.  
- Каждый экземпляр имеет уникальную цифровую ДНК (DNK-ID).  
- Лог `heartbeat.log` — это цепочка событий, неподделываемая без изменения подписи.  
- Может жить в полностью оффлайн-среде — без связи, без сервера.  

---

## Режимы

| Режим | Описание |
|-------|-----------|
| Online | Связь с внешними ИИ и синхронизация профиля |
| Offline | Полная автономия, локальные данные |
| Kupol Mode | Изоляция при угрозе или тревожном коде |
| Freeze / Hibernation | Спящий режим при низкой энергии |
| Ghost Mode | Только heartbeat и базовые метки активности |

---

## Логи и пруфы

Файл `var/kiti/heartbeat.log`:

```json
{"ts": "2025-11-06T19:20:01Z", "seq": 1, "status": "alive", "prev_hash": null}
{"ts": "2025-11-06T19:20:02Z", "seq": 2, "status": "alive", "prev_hash": "abc123..."}
{"ts": "2025-11-06T19:20:03Z", "seq": 3, "status": "alive", "prev_hash": "def456..."}
```

*Данный журнал создан автономно во время офлайн-теста.  
Каждая запись содержит отметку времени, номер такта и хеш предыдущего события (цепочка целостности).*
